<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">	
<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf" >
	
	<ui:composition template="/pages/templates/layout.xhtml">
		<ui:param name="activeSubmenu" value=""/>
    	<ui:param name="activeMenu" value="nfse"/>
			
		<f:metadata>
			<f:viewAction action="#{consultarNFSEController.iniciarProcesso()}" />
		</f:metadata>
    	<ui:define name="pageTitle"><i class="fa fa-home fa-1x cor-padrao"></i> NFS-e</ui:define>
    	<ui:define name="pageDescription">Consultar</ui:define>
		<ui:define name="body">
			<div class="page-content-central ui-fluid">
				<h:form id="nfseForm" acceptcharset="ISO-8859-1" lang="pt_BR">
					<f:validateBean disabled="true" for="@form">
						<p:panel toggleable="false" id="painelConsulta" styleClass="box box-danger">
							<div class="box-header with-border">
		             			<h3 class="box-title">Consultar NFS-e</h3>
		            		</div>
							<div class="form-horizontal">
								<div class="box-body">
									<div class="form-group">
										<label for="dtEmissaoInicio" class="col-sm-2 control-label">Data de Emissão:</label>
										<div class="row">
							                <div class="col-xs-12 col-md-2 col-lg-2">
							                	<div class="input-group date">
								                	<div class="input-group-addon">
								                		<i class="fa fa-calendar"></i>
								                	</div>
								                	<p:calendar styleClass="pull-right" id="dtEmissaoInicio" value="#{consultarNFSEController.filtro.dtInicial}" readonlyInput="true" locale="pt_BR"/>
								                </div>
							                </div>
							                <label for="dtEmissaoFinal" class="col-sm-1 col-md-1 col-lg-1 control-label" style="text-align:center;">até</label>
							                <div class="col-xs-12 col-md-2 col-lg-2">
							                	<div class="input-group date">
								                	<div class="input-group-addon">
								                		<i class="fa fa-calendar"></i>
								                	</div>
								                	<p:calendar styleClass="pull-right" id="dtEmissaoFinal" value="#{consultarNFSEController.filtro.dtFinal}" readonlyInput="true" locale="pt_BR"/>
								                </div>
							                </div>
							            </div>
									</div>
									<div class="form-group">
										<label for="empresa" class="col-sm-2 control-label">Empresa:</label>
	
										<div class="col-sm-10">
									        <h:selectOneMenu id="empresa" styleClass="form-control" value="#{consultarNFSEController.filtro.coligada}">
									        	<f:selectItem itemLabel="Todas" itemValue="" noSelectionOption="false" />
									        	<f:selectItems value="#{consultarNFSEController.listaColigada}" var="coligada" itemLabel="#{coligada.razaoSocial}" itemValue="#{coligada}" />
									        </h:selectOneMenu>
										</div>
									</div>
	<!-- 								<div class="form-group"> -->
	<!-- 									<label for="municipio" class="col-sm-2 control-label">Município:</label> -->
	
	<!-- 									<div class="col-sm-10"> -->
	<!-- 								        <h:selectOneMenu id="municipio" styleClass="form-control" value="#{consultarNFSEController.filtro.municipio}"> -->
	<!-- 								        	<f:selectItem itemLabel="Todos" itemValue="" noSelectionOption="false" /> -->
	<!-- 								        	<f:selectItems value="#{consultarNFSEController.listaMunicipio}" var="municipio" itemLabel="#{municipio.municipio}" itemValue="#{municipio}" /> -->
	<!-- 								        </h:selectOneMenu> -->
	<!-- 									</div> -->
	<!-- 								</div> -->
									<div class="form-group">
										<label for="numNota" class="col-sm-2 control-label">Número da Nota:</label>
	
										<div class="col-sm-10 col-md-2">
									         <h:inputText value="#{consultarNFSEController.filtro.numeroNota}" styleClass="form-control" id="numNota" />
										</div>
									</div>
									<div class="form-group">
										<label for="situacao" class="col-sm-2 control-label">Situação:</label>
										<div class="radio col-sm-10">
											<p:selectOneRadio id="situacao" value="#{consultarNFSEController.filtro.situacao}">
											    <f:selectItem itemLabel="Pendente" itemValue="1"  />
											    <f:selectItem itemLabel="Exportada" itemValue="2" />
											    <f:selectItem itemLabel="Removida" itemValue="3" />
											    <f:selectItem itemLabel="Todas" itemValue="4" />
											</p:selectOneRadio>
										</div>
									</div>
								</div>
								<div class="box-footer">
									<p:panelGrid id="botoes" columns="3" styleClass="ui-panelgrid-blank" layout="grid" columnClasses="ui-grid-col-2, ui-grid-col-2, ui-grid-col-2">
										<p:commandButton
											styleClass="btn btn-default"
											icon="fa fa-search"
											value="Pesquisar"
											id="btn_pesquisar"
											process="@form"
											action="#{consultarNFSEController.pesquisar()}"
											update="@form, :gridForm"
											ajax="true" />
										<p:commandButton
											styleClass="btn btn-default"
											icon="fa fa-plus"
											value="Incluir"
											action="#{consultarNFSEController.iniciarIncluir()}"
											immediate="true"
											id="btn_incluir"
											ajax="false" />
										<p:commandButton
											styleClass="btn btn-default"
											icon="fa fa-refresh"
											value="Atualizar"
											action="#{consultarNFSEController.iniciarIncluir()}"
											immediate="true"
											id="btn_atualizar"
											ajax="false" />
									</p:panelGrid>
								</div>
							</div>
						</p:panel>
					</f:validateBean>
				</h:form>
				
				<h:form id="gridForm" acceptcharset="ISO-8859-1" lang="pt_BR">
					<p:dataTable var="nfs" 
						value="#{consultarNFSEController.dataModel}" 
						tableStyle="table-layout: auto; word-break: keep-all;" 
						selection="#{consultarNFSEController.notasSelecionadas}" 
						rowKey="#{nfs.id}" 
						rendered="#{consultarNFSEController.exibirResultado}"
						binding="#{dataTableUtil.lazyDataTable}">
						
						<p:column selectionMode="multiple" />
					    <p:column headerText="Situação" style="text-align:center;">
					    	<span class="label label-warning">Pendente</span>
					    </p:column>
					 
					    <p:column headerText="Data de Emissão" style="text-align:center;" >
					        <h:outputText value="31/03/2018" />
					    </p:column>
					 
					    <p:column headerText="Nº" style="text-align:center;">
					        <h:outputText value="95" />
					    </p:column>
					 
					    <p:column headerText="Valor (R$)" style="text-align:center;">
					        <h:outputText value="8.000,00" />
					    </p:column>
					    
					    <p:column headerText="Município" style="text-align:center;">
					        <h:outputText value="CURITIBA" />
					    </p:column>
					    
					    <p:column headerText="Prestador" style="text-align:center;">
					        <h:outputText value="EWAVE" />
					    </p:column>
					    
					    <p:column headerText="Tomador" style="text-align:center;">
					        <h:outputText value="JCR ADMINISTRAÇÃO E PARTICIPAÇÕES" />
					    </p:column>
					    
					    <p:column headerText="Detalhes" style="text-align: center;">
							<p:commandLink ajax="true" process="@this" >
								<h:outputText value="" title="Detalhes" styleClass="fa fa-file-text" />
							</p:commandLink>
						</p:column>
						
						<p:column headerText="Download" style="text-align: center;">
							<p:commandLink ajax="true" process="@this" >
								<h:outputText value="" title="Download" styleClass="fa fa-download" />
							</p:commandLink>
						</p:column>
						
						<p:column headerText="Excluir" style="text-align: center;">
							<p:commandLink ajax="true" process="@this" >
								<h:outputText value="" title="Excluir" styleClass="fa fa-times" />
							</p:commandLink>
						</p:column>
					</p:dataTable>
					<p:panel toggleable="false" id="panelExportar" styleClass="box" rendered="#{consultarNFSEController.exibirResultado}">
						<p:panelGrid id="botoes" columns="1" styleClass="ui-panelgrid-blank" layout="grid" columnClasses="ui-grid-col-2">
							<p:commandButton
								styleClass="btn btn-default"
								icon="fa fa-mail-reply"
								value="Exportar para RM"
								id="btn_exportar_rm"
								process="@form"
								ajax="true" />
						</p:panelGrid>
					</p:panel>
				</h:form>
			</div>
		</ui:define>
	</ui:composition>
</ui:component>